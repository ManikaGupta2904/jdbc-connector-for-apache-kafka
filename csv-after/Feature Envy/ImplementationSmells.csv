Project Name,Package Name,Type Name,Method Name,Implementation Smell,Cause of the Smell,Method start line no
sink,io.aiven.connect.jdbc.sink,JdbcDbWriterTest,shouldGenerateNormalizedTableNameForTopic,Long Statement,The length of the statement "assertThat(jdbcDbWriter.generateTableNameFor("this.is.topic.with.dots")).isEqualTo("kafka_topic_this_is_topic_with_dots");" is 122.,79
sink,io.aiven.connect.jdbc.sink,JdbcDbWriterTest,shouldGenerateNormalizedTableNameForTopic,Long Statement,The length of the statement "assertThat(jdbcDbWriter.generateTableNameFor("this.is.topic.with.dots.and.weired.characters#$%")).isEqualTo("kafka_topic_this_is_topic_with_dots_and_weired_characters___");" is 172.,79
sink,io.aiven.connect.jdbc.sink,JdbcDbWriterTest,autoCreateWithAutoEvolve,Long Statement,The length of the statement "final Schema valueSchema1=SchemaBuilder.struct().field("author"`Schema.STRING_SCHEMA).field("title"`Schema.STRING_SCHEMA).build();" is 130.,138
sink,io.aiven.connect.jdbc.sink,JdbcDbWriterTest,autoCreateWithAutoEvolve,Long Statement,The length of the statement "final Schema valueSchema2=SchemaBuilder.struct().field("author"`Schema.STRING_SCHEMA).field("title"`Schema.STRING_SCHEMA).field("year"`Schema.OPTIONAL_INT32_SCHEMA).field("review"`SchemaBuilder.string().defaultValue("").build());" is 229.,138
sink,io.aiven.connect.jdbc.sink,JdbcDbWriterTest,autoCreateWithAutoEvolve,Long Statement,The length of the statement "final Struct valueStruct2=new Struct(valueSchema2).put("author"`"Tom Robbins").put("title"`"Fierce Invalids").put("year"`2016);" is 127.,138
sink,io.aiven.connect.jdbc.sink,JdbcDbWriterTest,autoCreateWithAutoEvolve,Magic Number,The method contains a magic number: 2016,138
sink,io.aiven.connect.jdbc.sink,JdbcDbWriterTest,autoCreateWithAutoEvolve,Magic Number,The method contains a magic number: 2L,138
sink,io.aiven.connect.jdbc.sink,JdbcDbWriterTest,multiInsertWithKafkaPkFailsDueToUniqueConstraint,Long Statement,The length of the statement "assertThatThrownBy(() -> writeSameRecordTwiceExpectingSingleUpdate(JdbcSinkConfig.InsertMode.INSERT`JdbcSinkConfig.PrimaryKeyMode.KAFKA`"")).isInstanceOf(SQLException.class);" is 174.,193
sink,io.aiven.connect.jdbc.sink,JdbcDbWriterTest,multiInsertWithRecordKeyPkFailsDueToUniqueConstraint,Long Statement,The length of the statement "assertThatThrownBy(() -> writeSameRecordTwiceExpectingSingleUpdate(JdbcSinkConfig.InsertMode.INSERT`JdbcSinkConfig.PrimaryKeyMode.RECORD_KEY`"")).isInstanceOf(SQLException.class);" is 179.,206
sink,io.aiven.connect.jdbc.sink,JdbcDbWriterTest,multiInsertWithRecordValuePkFailsDueToUniqueConstraint,Long Statement,The length of the statement "assertThatThrownBy(() -> writeSameRecordTwiceExpectingSingleUpdate(JdbcSinkConfig.InsertMode.INSERT`JdbcSinkConfig.PrimaryKeyMode.RECORD_VALUE`"author`title")).isInstanceOf(SQLException.class);" is 193.,219
sink,io.aiven.connect.jdbc.sink,JdbcDbWriterTest,idempotentUpsertWithRecordValuePk,Long Statement,The length of the statement "writeSameRecordTwiceExpectingSingleUpdate(JdbcSinkConfig.InsertMode.UPSERT`JdbcSinkConfig.PrimaryKeyMode.RECORD_VALUE`"author`title");" is 134.,226
sink,io.aiven.connect.jdbc.sink,JdbcDbWriterTest,writeSameRecordTwiceExpectingSingleUpdate,Long Statement,The length of the statement "final Schema valueSchema=SchemaBuilder.struct().field("author"`Schema.STRING_SCHEMA).field("title"`Schema.STRING_SCHEMA).build();" is 129.,232
sink,io.aiven.connect.jdbc.sink,JdbcDbWriterTest,writeSameRecordTwiceExpectingSingleUpdate,Magic Number,The method contains a magic number: 7,232
sink,io.aiven.connect.jdbc.sink,JdbcDbWriterTest,writeSameRecordTwiceExpectingSingleUpdate,Magic Number,The method contains a magic number: 42,232
sink,io.aiven.connect.jdbc.sink,JdbcDbWriterTest,writeSameRecordTwiceExpectingSingleUpdate,Magic Number,The method contains a magic number: 2,232
sink,io.aiven.connect.jdbc.sink,JdbcDbWriterTest,sameRecordNTimes,Long Statement,The length of the statement "final String createTable="CREATE TABLE " + testId + " ("+ " the_byte INTEGER`"+ " the_short INTEGER`"+ " the_int INTEGER`"+ " the_long INTEGER`"+ " the_float REAL`"+ " the_double REAL`"+ " the_bool INTEGER`"+ " the_string TEXT`"+ " the_bytes BLOB` "+ " the_decimal NUMERIC`"+ " the_date NUMERIC`"+ " the_time NUMERIC`"+ " the_timestamp NUMERIC"+ ");";" is 351.,274
sink,io.aiven.connect.jdbc.sink,JdbcDbWriterTest,sameRecordNTimes,Long Statement,The length of the statement "final Schema schema=SchemaBuilder.struct().name(testId).field("the_byte"`Schema.INT8_SCHEMA).field("the_short"`Schema.INT16_SCHEMA).field("the_int"`Schema.INT32_SCHEMA).field("the_long"`Schema.INT64_SCHEMA).field("the_float"`Schema.FLOAT32_SCHEMA).field("the_double"`Schema.FLOAT64_SCHEMA).field("the_bool"`Schema.BOOLEAN_SCHEMA).field("the_string"`Schema.STRING_SCHEMA).field("the_bytes"`Schema.BYTES_SCHEMA).field("the_decimal"`Decimal.schema(2).schema()).field("the_date"`Date.SCHEMA).field("the_time"`Time.SCHEMA).field("the_timestamp"`Timestamp.SCHEMA);" is 558.,274
sink,io.aiven.connect.jdbc.sink,JdbcDbWriterTest,sameRecordNTimes,Long Statement,The length of the statement "final Struct struct=new Struct(schema).put("the_byte"`(byte)-32).put("the_short"`(short)1234).put("the_int"`42).put("the_long"`12425436L).put("the_float"`2356.3f).put("the_double"`-2436546.56457d).put("the_bool"`true).put("the_string"`"foo").put("the_bytes"`new byte[]{-32`124}).put("the_decimal"`new BigDecimal("1234.567")).put("the_date"`instant).put("the_time"`instant).put("the_timestamp"`instant);" is 402.,274
sink,io.aiven.connect.jdbc.sink,JdbcDbWriterTest,sameRecordNTimes,Long Statement,The length of the statement "assertThat(rs.getTimestamp("the_timestamp")).isEqualTo(new java.sql.Timestamp(((java.util.Date)struct.get("the_time")).getTime()));" is 131.,274
sink,io.aiven.connect.jdbc.sink,JdbcDbWriterTest,sameRecordNTimes,Magic Number,The method contains a magic number: 2,274
sink,io.aiven.connect.jdbc.sink,JdbcDbWriterTest,sameRecordNTimes,Magic Number,The method contains a magic number: 1474661402123L,274
sink,io.aiven.connect.jdbc.sink,JdbcDbWriterTest,sameRecordNTimes,Magic Number,The method contains a magic number: 32,274
sink,io.aiven.connect.jdbc.sink,JdbcDbWriterTest,sameRecordNTimes,Magic Number,The method contains a magic number: 1234,274
sink,io.aiven.connect.jdbc.sink,JdbcDbWriterTest,sameRecordNTimes,Magic Number,The method contains a magic number: 42,274
sink,io.aiven.connect.jdbc.sink,JdbcDbWriterTest,sameRecordNTimes,Magic Number,The method contains a magic number: 12425436L,274
sink,io.aiven.connect.jdbc.sink,JdbcDbWriterTest,sameRecordNTimes,Magic Number,The method contains a magic number: 2356.3f,274
sink,io.aiven.connect.jdbc.sink,JdbcDbWriterTest,sameRecordNTimes,Magic Number,The method contains a magic number: 2436546.56457d,274
sink,io.aiven.connect.jdbc.sink,JdbcDbWriterTest,sameRecordNTimes,Magic Number,The method contains a magic number: 32,274
sink,io.aiven.connect.jdbc.sink,JdbcDbWriterTest,sameRecordNTimes,Magic Number,The method contains a magic number: 20,274
sink,io.aiven.connect.jdbc.sink,JdbcDbWriterTest,sameRecordNTimes,Magic Number,The method contains a magic number: 80,274
sink,io.aiven.connect.jdbc.sink,JdbcDbWriterTest,sameRecordNTimes,Magic Number,The method contains a magic number: 20,274
sink,io.aiven.connect.jdbc.sink,JdbcDbWriterTest,sameRecordNTimes,Magic Number,The method contains a magic number: 100,274
sink,io.aiven.connect.jdbc.sink,JdbcDbWriterTest,sameRecordNTimes,Magic Number,The method contains a magic number: 0.01f,274
sink,io.aiven.connect.jdbc.sink,JdbcDbWriterTest,sameRecordNTimes,Magic Number,The method contains a magic number: 0.01d,274
sink,io.aiven.connect.jdbc.sink,SqliteHelper,deleteTable,Magic Number,The method contains a magic number: 100,71
sink,io.aiven.connect.jdbc.sink,BufferedRecordsTest,correctBatching,Long Statement,The length of the statement "final Schema schemaB=SchemaBuilder.struct().field("name"`Schema.STRING_SCHEMA).field("age"`Schema.OPTIONAL_INT32_SCHEMA).build();" is 129.,70
sink,io.aiven.connect.jdbc.sink,BufferedRecordsTest,correctBatching,Magic Number,The method contains a magic number: 1000,70
sink,io.aiven.connect.jdbc.sink,BufferedRecordsTest,correctBatching,Magic Number,The method contains a magic number: 4,70
sink,io.aiven.connect.jdbc.sink,BufferedRecordsTest,testFlushSuccessNoInfo,Long Statement,The length of the statement "when(dbStructureMock.createOrAmendIfNecessary(any(JdbcSinkConfig.class)`any(Connection.class)`any(TableId.class)`any(FieldsMetadata.class))).thenReturn(true);" is 158.,114
sink,io.aiven.connect.jdbc.sink,BufferedRecordsTest,testFlushSuccessNoInfo,Magic Number,The method contains a magic number: 1000,114
sink,io.aiven.connect.jdbc.sink,BufferedRecordsTest,testInsertModeUpdate,Long Statement,The length of the statement "when(dbStructureMock.createOrAmendIfNecessary(any(JdbcSinkConfig.class)`any(Connection.class)`any(TableId.class)`any(FieldsMetadata.class))).thenReturn(true);" is 158.,157
sink,io.aiven.connect.jdbc.sink,BufferedRecordsTest,testInsertModeUpdate,Magic Number,The method contains a magic number: 1000,157
sink,io.aiven.connect.jdbc.sink,BufferedRecordsTest,testInsertModeWithDeleteEnabled,Long Statement,The length of the statement "when(dbStructureMock.createOrAmendIfNecessary(any(JdbcSinkConfig.class)`any(Connection.class)`any(TableId.class)`any(FieldsMetadata.class))).thenReturn(true);" is 158.,194
sink,io.aiven.connect.jdbc.sink,BufferedRecordsTest,testInsertModeWithDeleteEnabled,Magic Number,The method contains a magic number: 1000,194
sink,io.aiven.connect.jdbc.sink,BufferedRecordsTest,testMultiInsertModeWithDeleteEnabled,Long Statement,The length of the statement "when(dbStructureMock.createOrAmendIfNecessary(any(JdbcSinkConfig.class)`any(Connection.class)`any(TableId.class)`any(FieldsMetadata.class))).thenReturn(true);" is 158.,239
sink,io.aiven.connect.jdbc.sink,BufferedRecordsTest,testMultiInsertModeWithDeleteEnabled,Magic Number,The method contains a magic number: 1000,239
sink,io.aiven.connect.jdbc.sink,BufferedRecordsTest,testInsertModeMultiAutomaticFlush,Long Statement,The length of the statement "when(dbStructureMock.createOrAmendIfNecessary(any(JdbcSinkConfig.class)`any(Connection.class)`any(TableId.class)`any(FieldsMetadata.class))).thenReturn(true);" is 158.,286
sink,io.aiven.connect.jdbc.sink,BufferedRecordsTest,testInsertModeMultiAutomaticFlush,Long Statement,The length of the statement "assertThat(sqlCaptor.getAllValues().get(0)).isEqualTo("INSERT INTO \"planets\"(\"name\"`\"planetid\") VALUES (?`?)`(?`?)");" is 123.,286
sink,io.aiven.connect.jdbc.sink,BufferedRecordsTest,testInsertModeMultiAutomaticFlush,Long Statement,The length of the statement "assertThat(sqlCaptor.getAllValues().get(1)).isEqualTo("INSERT INTO \"planets\"(\"name\"`\"planetid\") VALUES (?`?)`(?`?)");" is 123.,286
sink,io.aiven.connect.jdbc.sink,BufferedRecordsTest,testInsertModeMultiAutomaticFlush,Magic Number,The method contains a magic number: 2,286
sink,io.aiven.connect.jdbc.sink,BufferedRecordsTest,testInsertModeMultiAutomaticFlush,Magic Number,The method contains a magic number: 5,286
sink,io.aiven.connect.jdbc.sink,BufferedRecordsTest,testInsertModeMultiAutomaticFlush,Magic Number,The method contains a magic number: 2,286
sink,io.aiven.connect.jdbc.sink,BufferedRecordsTest,testInsertModeMultiExplicitFlush,Long Statement,The length of the statement "when(dbStructureMock.createOrAmendIfNecessary(any(JdbcSinkConfig.class)`any(Connection.class)`any(TableId.class)`any(FieldsMetadata.class))).thenReturn(true);" is 158.,322
sink,io.aiven.connect.jdbc.sink,BufferedRecordsTest,testInsertModeMultiExplicitFlush,Magic Number,The method contains a magic number: 100,322
sink,io.aiven.connect.jdbc.sink,BufferedRecordsTest,testInsertModeMultiExplicitFlush,Magic Number,The method contains a magic number: 2,322
sink,io.aiven.connect.jdbc.sink,BufferedRecordsTest,multiModeConfig,Long Statement,The length of the statement "return new JdbcSinkConfig(Map.of("connection.url"`""`"auto.create"`true`"auto.evolve"`true`"batch.size"`batchSize`"insert.mode"`"multi"));" is 138.,369
sink,io.aiven.connect.jdbc.sink,SqliteHelperTest,returnTheDatabaseTableInformation,Long Statement,The length of the statement "final String createEmployees="CREATE TABLE employees\n" + "( employee_id INTEGER PRIMARY KEY AUTOINCREMENT`\n" + " last_name VARCHAR NOT NULL`\n"+ " first_name VARCHAR`\n"+ " hire_date DATE\n"+ ");";" is 199.,53
sink,io.aiven.connect.jdbc.sink,SqliteHelperTest,returnTheDatabaseTableInformation,Long Statement,The length of the statement "final String createProducts="CREATE TABLE products\n" + "( product_id INTEGER PRIMARY KEY AUTOINCREMENT`\n" + " product_name VARCHAR NOT NULL`\n"+ " quantity INTEGER NOT NULL DEFAULT 0\n"+ ");";" is 194.,53
sink,io.aiven.connect.jdbc.sink,SqliteHelperTest,returnTheDatabaseTableInformation,Magic Number,The method contains a magic number: 2,53
sink,io.aiven.connect.jdbc.sink,SqliteHelperTest,returnTheDatabaseTableInformation,Magic Number,The method contains a magic number: 4,53
sink,io.aiven.connect.jdbc.sink,SqliteHelperTest,returnTheDatabaseTableInformation,Magic Number,The method contains a magic number: 4,53
sink,io.aiven.connect.jdbc.sink,JdbcSinkConnectorTest,testValidate_withDeleteEnabledAndPkModeNotRecordKey_shouldAddErrorMessage,Long Statement,The length of the statement "final Optional<ConfigValue> deleteEnabledConfigValue=validatedConfig.configValues().stream().filter(cv -> cv.name().equals(JdbcSinkConfig.DELETE_ENABLED)).findFirst();" is 167.,43
sink,io.aiven.connect.jdbc.sink,JdbcSinkConnectorTest,testValidate_withDeleteEnabledAndPkModeNotRecordKey_shouldAddErrorMessage,Long Statement,The length of the statement "deleteEnabledConfigValue.ifPresent(value -> assertTrue(value.errorMessages().contains("Delete support only works with pk.mode=record_key")));" is 141.,43
sink,io.aiven.connect.jdbc.sink,JdbcSinkConnectorTest,testValidate_withDeleteEnabledAndPkModeRecordKey_shouldNotAddErrorMessage,Long Statement,The length of the statement "final Optional<ConfigValue> deleteEnabledConfigValue=validatedConfig.configValues().stream().filter(cv -> cv.name().equals(JdbcSinkConfig.DELETE_ENABLED)).findFirst();" is 167.,61
sink,io.aiven.connect.jdbc.sink,JdbcSinkConnectorTest,testValidate_withDeleteEnabledAndPkModeRecordKey_shouldNotAddErrorMessage,Long Statement,The length of the statement "deleteEnabledConfigValue.ifPresent(value -> assertFalse(value.errorMessages().contains("Delete support only works with pk.mode=record_key")));" is 142.,61
sink,io.aiven.connect.jdbc.sink,JdbcSinkConnectorTest,testValidate_pkModeRecordKey_shouldNotAddErrorMessage,Long Statement,The length of the statement "final Optional<ConfigValue> deleteEnabledConfigValue=validatedConfig.configValues().stream().filter(cv -> cv.name().equals(JdbcSinkConfig.DELETE_ENABLED)).findFirst();" is 167.,79
sink,io.aiven.connect.jdbc.sink,JdbcSinkConnectorTest,testValidate_pkModeRecordKey_shouldNotAddErrorMessage,Long Statement,The length of the statement "deleteEnabledConfigValue.ifPresent(value -> assertFalse(value.errorMessages().contains("Delete support only works with pk.mode=record_key")));" is 142.,79
sink,io.aiven.connect.jdbc.sink,JdbcSinkConnectorTest,testValidate_withDeleteDisabled_shouldNotAddErrorMessage,Long Statement,The length of the statement "final Optional<ConfigValue> deleteEnabledConfigValue=validatedConfig.configValues().stream().filter(cv -> cv.name().equals(JdbcSinkConfig.DELETE_ENABLED)).findFirst();" is 167.,96
sink,io.aiven.connect.jdbc.sink,JdbcSinkTaskTest,putPropagatesToDbWithAutoCreateAndPkModeKafka,Long Statement,The length of the statement "final Struct struct=new Struct(SCHEMA).put("firstName"`"Alex").put("lastName"`"Smith").put("bool"`true).put("short"`(short)1234).put("byte"`(byte)-32).put("long"`12425436L).put("float"`(float)2356.3).put("double"`-2436546.56457).put("age"`21).put("modified"`new Date(1474661402123L));" is 284.,80
sink,io.aiven.connect.jdbc.sink,JdbcSinkTaskTest,putPropagatesToDbWithAutoCreateAndPkModeKafka,Magic Number,The method contains a magic number: 1234,80
sink,io.aiven.connect.jdbc.sink,JdbcSinkTaskTest,putPropagatesToDbWithAutoCreateAndPkModeKafka,Magic Number,The method contains a magic number: 32,80
sink,io.aiven.connect.jdbc.sink,JdbcSinkTaskTest,putPropagatesToDbWithAutoCreateAndPkModeKafka,Magic Number,The method contains a magic number: 12425436L,80
sink,io.aiven.connect.jdbc.sink,JdbcSinkTaskTest,putPropagatesToDbWithAutoCreateAndPkModeKafka,Magic Number,The method contains a magic number: 2356.3,80
sink,io.aiven.connect.jdbc.sink,JdbcSinkTaskTest,putPropagatesToDbWithAutoCreateAndPkModeKafka,Magic Number,The method contains a magic number: 2436546.56457,80
sink,io.aiven.connect.jdbc.sink,JdbcSinkTaskTest,putPropagatesToDbWithAutoCreateAndPkModeKafka,Magic Number,The method contains a magic number: 21,80
sink,io.aiven.connect.jdbc.sink,JdbcSinkTaskTest,putPropagatesToDbWithAutoCreateAndPkModeKafka,Magic Number,The method contains a magic number: 1474661402123L,80
sink,io.aiven.connect.jdbc.sink,JdbcSinkTaskTest,putPropagatesToDbWithAutoCreateAndPkModeKafka,Magic Number,The method contains a magic number: 42,80
sink,io.aiven.connect.jdbc.sink,JdbcSinkTaskTest,putPropagatesToDbWithAutoCreateAndPkModeKafka,Magic Number,The method contains a magic number: 42,80
sink,io.aiven.connect.jdbc.sink,JdbcSinkTaskTest,putPropagatesToDbWithAutoCreateAndPkModeKafka,Magic Number,The method contains a magic number: 0.01f,80
sink,io.aiven.connect.jdbc.sink,JdbcSinkTaskTest,putPropagatesToDbWithAutoCreateAndPkModeKafka,Magic Number,The method contains a magic number: 0.01,80
sink,io.aiven.connect.jdbc.sink,JdbcSinkTaskTest,putPropagatesToDbWithPkModeRecordValue,Long Statement,The length of the statement "sqliteHelper.createTable("CREATE TABLE " + topic + "("+ " firstName TEXT`"+ " lastName TEXT`"+ " age INTEGER`"+ " bool NUMERIC`"+ " byte INTEGER`"+ " short INTEGER NULL`"+ " long INTEGER`"+ " float NUMERIC`"+ " double NUMERIC`"+ " bytes BLOB`"+ " modified DATETIME` "+ "PRIMARY KEY (firstName` lastName));");" is 308.,138
sink,io.aiven.connect.jdbc.sink,JdbcSinkTaskTest,putPropagatesToDbWithPkModeRecordValue,Long Statement,The length of the statement "final Struct struct=new Struct(SCHEMA).put("firstName"`"Christina").put("lastName"`"Brams").put("bool"`false).put("byte"`(byte)-72).put("long"`8594L).put("double"`3256677.56457d).put("age"`28).put("modified"`new Date(1474661402123L));" is 234.,138
sink,io.aiven.connect.jdbc.sink,JdbcSinkTaskTest,putPropagatesToDbWithPkModeRecordValue,Long Statement,The length of the statement "final String query="SELECT * FROM " + topic + " WHERE firstName='"+ struct.getString("firstName")+ "' and lastName='"+ struct.getString("lastName")+ "'";" is 153.,138
sink,io.aiven.connect.jdbc.sink,JdbcSinkTaskTest,putPropagatesToDbWithPkModeRecordValue,Long Statement,The length of the statement "final java.sql.Timestamp dbTimestamp=rs.getTimestamp("modified"`DateTimeUtils.getTimeZoneCalendar(TimeZone.getTimeZone(ZoneOffset.UTC)));" is 137.,138
sink,io.aiven.connect.jdbc.sink,JdbcSinkTaskTest,putPropagatesToDbWithPkModeRecordValue,Magic Number,The method contains a magic number: 72,138
sink,io.aiven.connect.jdbc.sink,JdbcSinkTaskTest,putPropagatesToDbWithPkModeRecordValue,Magic Number,The method contains a magic number: 8594L,138
sink,io.aiven.connect.jdbc.sink,JdbcSinkTaskTest,putPropagatesToDbWithPkModeRecordValue,Magic Number,The method contains a magic number: 3256677.56457d,138
sink,io.aiven.connect.jdbc.sink,JdbcSinkTaskTest,putPropagatesToDbWithPkModeRecordValue,Magic Number,The method contains a magic number: 28,138
sink,io.aiven.connect.jdbc.sink,JdbcSinkTaskTest,putPropagatesToDbWithPkModeRecordValue,Magic Number,The method contains a magic number: 1474661402123L,138
sink,io.aiven.connect.jdbc.sink,JdbcSinkTaskTest,putPropagatesToDbWithPkModeRecordValue,Magic Number,The method contains a magic number: 43,138
sink,io.aiven.connect.jdbc.sink,JdbcSinkTaskTest,putPropagatesToDbWithPkModeRecordValue,Magic Number,The method contains a magic number: 0.01,138
sink,io.aiven.connect.jdbc.sink,JdbcSinkTaskTest,retries,Long Statement,The length of the statement "assertThatThrownBy(() -> task.put(records)).isNotInstanceOf(RetriableException.class).isInstanceOf(ConnectException.class).hasCauseInstanceOf(SQLException.class);" is 162.,208
sink,io.aiven.connect.jdbc.sink,JdbcSinkTaskTest,retries,Magic Number,The method contains a magic number: 2,208
sink,io.aiven.connect.jdbc.sink,JdbcSinkTaskTest,retries,Magic Number,The method contains a magic number: 1000,208
sink,io.aiven.connect.jdbc.sink,PreparedStatementBinderTest,bindRecordInsert,Long Statement,The length of the statement "final Schema valueSchema=SchemaBuilder.struct().name("com.example.Person").field("firstName"`Schema.STRING_SCHEMA).field("lastName"`Schema.STRING_SCHEMA).field("age"`Schema.INT32_SCHEMA).field("bool"`Schema.BOOLEAN_SCHEMA).field("short"`Schema.INT16_SCHEMA).field("byte"`Schema.INT8_SCHEMA).field("long"`Schema.INT64_SCHEMA).field("float"`Schema.FLOAT32_SCHEMA).field("double"`Schema.FLOAT64_SCHEMA).field("bytes"`Schema.BYTES_SCHEMA).field("decimal"`Decimal.schema(0)).field("date"`Date.SCHEMA).field("time"`Time.SCHEMA).field("timestamp"`Timestamp.SCHEMA).field("threshold"`Schema.OPTIONAL_FLOAT64_SCHEMA).build();" is 616.,69
sink,io.aiven.connect.jdbc.sink,PreparedStatementBinderTest,bindRecordInsert,Long Statement,The length of the statement "final Struct valueStruct=new Struct(valueSchema).put("firstName"`"Alex").put("lastName"`"Smith").put("bool"`true).put("short"`(short)1234).put("byte"`(byte)-32).put("long"`(long)12425436).put("float"`(float)2356.3).put("double"`-2436546.56457).put("bytes"`new byte[]{-32`124}).put("age"`30).put("decimal"`new BigDecimal("1.5").setScale(0`RoundingMode.HALF_EVEN)).put("date"`new java.util.Date(0)).put("time"`new java.util.Date(1000)).put("timestamp"`new java.util.Date(100));" is 475.,69
sink,io.aiven.connect.jdbc.sink,PreparedStatementBinderTest,bindRecordInsert,Long Statement,The length of the statement "final FieldsMetadata fieldsMetadata=FieldsMetadata.extract("people"`pkMode`pkFields`Collections.<String>emptySet()`schemaPair);" is 127.,69
sink,io.aiven.connect.jdbc.sink,PreparedStatementBinderTest,bindRecordInsert,Long Statement,The length of the statement "final PreparedStatementBinder binder=new PreparedStatementBinder(dialect`statement`pkMode`schemaPair`fieldsMetadata`JdbcSinkConfig.InsertMode.INSERT);" is 150.,69
sink,io.aiven.connect.jdbc.sink,PreparedStatementBinderTest,bindRecordInsert,Long Statement,The length of the statement "verify(statement).setTimestamp(index++`new java.sql.Timestamp(((java.util.Date)valueStruct.get("timestamp")).getTime())`utcCalendar);" is 133.,69
sink,io.aiven.connect.jdbc.sink,PreparedStatementBinderTest,bindRecordInsert,Magic Number,The method contains a magic number: 1234,69
sink,io.aiven.connect.jdbc.sink,PreparedStatementBinderTest,bindRecordInsert,Magic Number,The method contains a magic number: 32,69
sink,io.aiven.connect.jdbc.sink,PreparedStatementBinderTest,bindRecordInsert,Magic Number,The method contains a magic number: 12425436,69
sink,io.aiven.connect.jdbc.sink,PreparedStatementBinderTest,bindRecordInsert,Magic Number,The method contains a magic number: 2356.3,69
sink,io.aiven.connect.jdbc.sink,PreparedStatementBinderTest,bindRecordInsert,Magic Number,The method contains a magic number: 2436546.56457,69
sink,io.aiven.connect.jdbc.sink,PreparedStatementBinderTest,bindRecordInsert,Magic Number,The method contains a magic number: 32,69
sink,io.aiven.connect.jdbc.sink,PreparedStatementBinderTest,bindRecordInsert,Magic Number,The method contains a magic number: 30,69
sink,io.aiven.connect.jdbc.sink,PreparedStatementBinderTest,bindRecordInsert,Magic Number,The method contains a magic number: 1000,69
sink,io.aiven.connect.jdbc.sink,PreparedStatementBinderTest,bindRecordInsert,Magic Number,The method contains a magic number: 100,69
sink,io.aiven.connect.jdbc.sink,PreparedStatementBinderTest,bindRecordUpsertMode,Long Statement,The length of the statement "final Schema valueSchema=SchemaBuilder.struct().name("com.example.Person").field("firstName"`Schema.STRING_SCHEMA).field("long"`Schema.INT64_SCHEMA).build();" is 157.,158
sink,io.aiven.connect.jdbc.sink,PreparedStatementBinderTest,bindRecordUpsertMode,Long Statement,The length of the statement "final FieldsMetadata fieldsMetadata=FieldsMetadata.extract("people"`pkMode`pkFields`Collections.<String>emptySet()`schemaPair);" is 127.,158
sink,io.aiven.connect.jdbc.sink,PreparedStatementBinderTest,bindRecordUpsertMode,Long Statement,The length of the statement "final PreparedStatementBinder binder=new PreparedStatementBinder(dialect`statement`pkMode`schemaPair`fieldsMetadata`JdbcSinkConfig.InsertMode.UPSERT);" is 150.,158
sink,io.aiven.connect.jdbc.sink,PreparedStatementBinderTest,bindRecordUpsertMode,Magic Number,The method contains a magic number: 12425436,158
sink,io.aiven.connect.jdbc.sink,PreparedStatementBinderTest,bindRecordUpdateMode,Long Statement,The length of the statement "final Schema valueSchema=SchemaBuilder.struct().name("com.example.Person").field("firstName"`Schema.STRING_SCHEMA).field("long"`Schema.INT64_SCHEMA).build();" is 157.,197
sink,io.aiven.connect.jdbc.sink,PreparedStatementBinderTest,bindRecordUpdateMode,Long Statement,The length of the statement "final FieldsMetadata fieldsMetadata=FieldsMetadata.extract("people"`pkMode`pkFields`Collections.<String>emptySet()`schemaPair);" is 127.,197
sink,io.aiven.connect.jdbc.sink,PreparedStatementBinderTest,bindRecordUpdateMode,Long Statement,The length of the statement "final PreparedStatementBinder binder=new PreparedStatementBinder(dialect`statement`pkMode`schemaPair`fieldsMetadata`JdbcSinkConfig.InsertMode.UPDATE);" is 150.,197
sink,io.aiven.connect.jdbc.sink,PreparedStatementBinderTest,bindRecordUpdateMode,Magic Number,The method contains a magic number: 12425436,197
sink,io.aiven.connect.jdbc.sink,JdbcSinkConfigTest,shouldValidatePKModeNoneWithPKFieldsSet,Long Statement,The length of the statement "assertTrue(config.configValues().stream().filter(cv -> cv.name().equals(JdbcSinkConfig.PK_FIELDS)).flatMap(cv -> cv.errorMessages().stream()).anyMatch(msg -> msg.contains("Primary key fields should not be set when pkMode is 'none'")));" is 235.,96
sink,io.aiven.connect.jdbc.sink,JdbcSinkConfigTest,shouldValidatePKModeKafkaWithInvalidPKFields,Long Statement,The length of the statement "assertTrue(config.configValues().stream().filter(cv -> cv.name().equals(JdbcSinkConfig.PK_FIELDS)).flatMap(cv -> cv.errorMessages().stream()).anyMatch(msg -> msg.contains("Primary key fields must be set with three fields " + "(topic` partition` offset) when pkMode is 'kafka'")));" is 280.,111
sink,io.aiven.connect.jdbc.sink,JdbcSinkConfigTest,shouldValidatePKModeRecordKeyWithNoPKFields,Long Statement,The length of the statement "assertTrue(config.configValues().stream().filter(cv -> cv.name().equals(JdbcSinkConfig.PK_FIELDS)).flatMap(cv -> cv.errorMessages().stream()).anyMatch(msg -> msg.contains("Primary key fields must be set when pkMode is 'record_key' or 'record_value'")));" is 253.,130
sink,io.aiven.connect.jdbc.sink,JdbcSinkConfigTest,shouldValidatePKModeRecordValueWithNoPKFields,Long Statement,The length of the statement "assertTrue(config.configValues().stream().filter(cv -> cv.name().equals(JdbcSinkConfig.PK_FIELDS)).flatMap(cv -> cv.errorMessages().stream()).anyMatch(msg -> msg.contains("Primary key fields must be set when pkMode is 'record_key' or 'record_value'")));" is 253.,147
sink,io.aiven.connect.jdbc.sink.metadata,FieldsMetadataTest,valueSchemaMustBePresentForPkModeRecordValue,Long Statement,The length of the statement "assertThatThrownBy(() -> extract(JdbcSinkConfig.PrimaryKeyMode.RECORD_VALUE`Collections.emptyList()`SIMPLE_PRIMITIVE_SCHEMA`null)).isInstanceOf(ConnectException.class);" is 168.,43
sink,io.aiven.connect.jdbc.sink.metadata,FieldsMetadataTest,valueSchemaMustBeStructIfPresent,Long Statement,The length of the statement "assertThatThrownBy(() -> extract(JdbcSinkConfig.PrimaryKeyMode.KAFKA`Collections.emptyList()`SIMPLE_PRIMITIVE_SCHEMA`SIMPLE_PRIMITIVE_SCHEMA)).isInstanceOf(ConnectException.class);" is 180.,54
sink,io.aiven.connect.jdbc.sink.metadata,FieldsMetadataTest,missingValueSchemaCanBeOk,Long Statement,The length of the statement "assertThat(extract(JdbcSinkConfig.PrimaryKeyMode.RECORD_KEY`Collections.emptyList()`SIMPLE_STRUCT_SCHEMA`null).allFields.keySet()).isEqualTo(Set.of("name"));" is 157.,65
sink,io.aiven.connect.jdbc.sink.metadata,FieldsMetadataTest,missingValueSchemaCanBeOk,Long Statement,The length of the statement "assertThat(Lists.newArrayList(extract(JdbcSinkConfig.PrimaryKeyMode.KAFKA`Collections.emptyList()`null`null).allFields.keySet())).isEqualTo(List.of("__connect_topic"`"__connect_partition"`"__connect_offset"));" is 209.,65
sink,io.aiven.connect.jdbc.sink.metadata,FieldsMetadataTest,metadataMayNotBeEmpty,Long Statement,The length of the statement "assertThatThrownBy(() -> extract(JdbcSinkConfig.PrimaryKeyMode.NONE`Collections.emptyList()`null`null)).isInstanceOf(ConnectException.class);" is 141.,84
sink,io.aiven.connect.jdbc.sink.metadata,FieldsMetadataTest,kafkaPkMode,Long Statement,The length of the statement "final FieldsMetadata metadata=extract(JdbcSinkConfig.PrimaryKeyMode.KAFKA`Collections.emptyList()`null`SIMPLE_STRUCT_SCHEMA);" is 125.,95
sink,io.aiven.connect.jdbc.sink.metadata,FieldsMetadataTest,kafkaPkMode,Long Statement,The length of the statement "assertThat(Lists.newArrayList(metadata.keyFieldNames)).isEqualTo(List.of("__connect_topic"`"__connect_partition"`"__connect_offset"));" is 134.,95
sink,io.aiven.connect.jdbc.sink.metadata,FieldsMetadataTest,kafkaPkModeBadFieldSpec,Long Statement,The length of the statement "assertThatThrownBy(() -> extract(JdbcSinkConfig.PrimaryKeyMode.KAFKA`List.of("lone")`null`SIMPLE_STRUCT_SCHEMA)).isInstanceOf(ConnectException.class);" is 150.,136
sink,io.aiven.connect.jdbc.sink.metadata,FieldsMetadataTest,recordKeyPkModePrimitiveKey,Long Statement,The length of the statement "final FieldsMetadata metadata=extract(JdbcSinkConfig.PrimaryKeyMode.RECORD_KEY`List.of("the_pk")`SIMPLE_PRIMITIVE_SCHEMA`SIMPLE_STRUCT_SCHEMA);" is 143.,147
sink,io.aiven.connect.jdbc.sink.metadata,FieldsMetadataTest,recordKeyPkModeWithPrimitiveKeyButMultiplePkFieldsSpecified,Long Statement,The length of the statement "assertThatThrownBy(() -> extract(JdbcSinkConfig.PrimaryKeyMode.RECORD_KEY`List.of("pk1"`"pk2")`SIMPLE_PRIMITIVE_SCHEMA`SIMPLE_STRUCT_SCHEMA)).isInstanceOf(ConnectException.class);" is 179.,174
sink,io.aiven.connect.jdbc.sink.metadata,FieldsMetadataTest,recordKeyPkModeButKeySchemaMissing,Long Statement,The length of the statement "assertThatThrownBy(() -> extract(JdbcSinkConfig.PrimaryKeyMode.RECORD_KEY`Collections.emptyList()`null`SIMPLE_STRUCT_SCHEMA)).isInstanceOf(ConnectException.class);" is 163.,185
sink,io.aiven.connect.jdbc.sink.metadata,FieldsMetadataTest,recordKeyPkModeButKeySchemaAsNonStructCompositeType,Long Statement,The length of the statement "assertThatThrownBy(() -> extract(JdbcSinkConfig.PrimaryKeyMode.RECORD_KEY`Collections.emptyList()`SIMPLE_MAP_SCHEMA`SIMPLE_STRUCT_SCHEMA)).isInstanceOf(ConnectException.class);" is 176.,196
sink,io.aiven.connect.jdbc.sink.metadata,FieldsMetadataTest,recordKeyPkModeWithStructKeyButMissingField,Long Statement,The length of the statement "assertThatThrownBy(() -> extract(JdbcSinkConfig.PrimaryKeyMode.RECORD_KEY`Collections.singletonList("nonexistent")`SIMPLE_STRUCT_SCHEMA`SIMPLE_STRUCT_SCHEMA)).isInstanceOf(ConnectException.class);" is 196.,207
sink,io.aiven.connect.jdbc.sink.metadata,FieldsMetadataTest,recordValuePkModeWithMissingPkField,Long Statement,The length of the statement "assertThatThrownBy(() -> extract(JdbcSinkConfig.PrimaryKeyMode.RECORD_VALUE`List.of("nonexistent")`SIMPLE_PRIMITIVE_SCHEMA`SIMPLE_STRUCT_SCHEMA)).isInstanceOf(ConnectException.class);" is 183.,218
sink,io.aiven.connect.jdbc.sink.metadata,FieldsMetadataTest,recordValuePkModeWithValidPkFields,Long Statement,The length of the statement "final FieldsMetadata metadata=extract(JdbcSinkConfig.PrimaryKeyMode.RECORD_VALUE`Collections.singletonList("name")`SIMPLE_PRIMITIVE_SCHEMA`SIMPLE_STRUCT_SCHEMA);" is 161.,229
sink,io.aiven.connect.jdbc.sink.metadata,FieldsMetadataTest,recordValuePkModeWithPkFieldsAndWhitelistFiltering,Long Statement,The length of the statement "final Schema valueSchema=SchemaBuilder.struct().field("field1"`Schema.INT64_SCHEMA).field("field2"`Schema.INT64_SCHEMA).field("field3"`Schema.INT64_SCHEMA).field("field4"`Schema.INT64_SCHEMA).build();" is 200.,246
sink,io.aiven.connect.jdbc.sink.metadata,FieldsMetadataTest,recordValuePkModeWithPkFieldsAndWhitelistFiltering,Long Statement,The length of the statement "final FieldsMetadata metadata=extract(JdbcSinkConfig.PrimaryKeyMode.RECORD_VALUE`Collections.singletonList("field1")`Set.of("field2"`"field4")`null`valueSchema);" is 161.,246
sink,io.aiven.connect.jdbc.sink.metadata,FieldsMetadataTest,recordValuePkModeWithFieldsInOriginalOrdering,Long Statement,The length of the statement "final Schema valueSchema=SchemaBuilder.struct().field("field4"`Schema.INT64_SCHEMA).field("field2"`Schema.INT64_SCHEMA).field("field1"`Schema.INT64_SCHEMA).field("field3"`Schema.INT64_SCHEMA).build();" is 200.,268
sink,io.aiven.connect.jdbc.sink.metadata,FieldsMetadataTest,recordValuePkModeWithFieldsInOriginalOrdering,Long Statement,The length of the statement "var metadata=extract(JdbcSinkConfig.PrimaryKeyMode.RECORD_VALUE`Collections.singletonList("field4")`Set.of("field3"`"field1"`"field2")`null`valueSchema);" is 153.,268
sink,io.aiven.connect.jdbc.sink.metadata,FieldsMetadataTest,recordValuePkModeWithFieldsInOriginalOrdering,Long Statement,The length of the statement "metadata=extract(JdbcSinkConfig.PrimaryKeyMode.RECORD_VALUE`Collections.singletonList("field1")`Set.of("field4"`"field3")`null`valueSchema);" is 140.,268
sink,io.aiven.connect.jdbc.sink.metadata,FieldsMetadataTest,recordValuePkModeWithFieldsInOriginalOrdering,Long Statement,The length of the statement "final var keySchema=SchemaBuilder.struct().field("field1"`Schema.INT64_SCHEMA).field("field3"`Schema.INT64_SCHEMA).field("field2"`Schema.INT64_SCHEMA).build();" is 159.,268
sink,io.aiven.connect.jdbc.sink.metadata,FieldsMetadataTest,recordValuePkModeWithFieldsInOriginalOrdering,Long Statement,The length of the statement "metadata=extract(JdbcSinkConfig.PrimaryKeyMode.RECORD_KEY`List.of("field2"`"field3"`"field1")`Set.of("field3"`"field1")`keySchema`null);" is 136.,268
sink,io.aiven.connect.jdbc.sink.metadata,FieldsMetadataTest,extract,Long Parameter List,The method has 5 parameters. ,324
